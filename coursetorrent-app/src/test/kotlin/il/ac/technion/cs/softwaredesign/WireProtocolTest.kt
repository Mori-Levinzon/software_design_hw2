package il.ac.technion.cs.softwaredesign

import org.junit.jupiter.api.Assertions.assertEquals
import org.junit.jupiter.api.Assertions.assertTrue
import org.junit.jupiter.api.Test

@ExperimentalUnsignedTypes
class WireProtocolTest {

    @Test
    fun `encode-decode have message`() {
        val haveMessageId: Byte = 4
        val pieceIndex = 113

        val encoded = WireProtocolEncoder.encode(haveMessageId, pieceIndex)
        val decoded = WireProtocolDecoder.decode(encoded, 1)

        assertEquals(pieceIndex, decoded.ints[0])
        assertEquals(haveMessageId, decoded.messageId)
        assertEquals(encoded.size, decoded.length + 4)
    }

    @Test
    fun `encode-decode piece message`() {
        val pieceMessageId: Byte = 7
        val pieceIndex = 113
        val begin = 32768
        val block = "A".repeat(16384).toByteArray()

        val encoded = WireProtocolEncoder.encode(pieceMessageId, block, pieceIndex, begin)
        val decoded = WireProtocolDecoder.decode(encoded, 2)

        assertEquals(pieceIndex, decoded.ints[0])
        assertEquals(begin, decoded.ints[1])
        assertTrue(block.contentEquals(decoded.contents))
        assertEquals(encoded.size, decoded.length + 4)
    }

    @Test
    fun `decode choke message`() {
        val chokeMessage = hexStringToByteArray("0000000101")

        val decoded = WireProtocolDecoder.decode(chokeMessage, 0)

        assertEquals(1, decoded.messageId)
        assertEquals(decoded.messageId, WireProtocolDecoder.messageId(chokeMessage))
        assertEquals(1, decoded.length)
        assertEquals(decoded.length, WireProtocolDecoder.length(chokeMessage))
    }

    @Test
    fun `decode bitfield message`() {
        val bitfieldMessage = hexStringToByteArray("0000004e05ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0")

        val decoded = WireProtocolDecoder.decode(bitfieldMessage, 0)

        assertEquals(5, decoded.messageId)
        assertEquals("E0".toUByte(16).toByte(), decoded.contents.last())
        assertEquals(decoded.messageId, WireProtocolDecoder.messageId(bitfieldMessage))
        assertEquals(decoded.length, WireProtocolDecoder.length(bitfieldMessage))

    }

    @Test
    fun `decode piece message`() {
        // That's one long line...
        val pieceMessage = hexStringToByteArray("00004009070000053200010000ddaffdda2fc35b962e446be3e7c0b0f842c31945b8e6811a046b9874f3ebd476de2bf7bc94b55b63385328c58f08fa63208d256a7e956fde6be7c500d7c6f899bf37c939eea467bab445df7d7f42263b5069ca37d08fb6590cd0671cb35bb2f2b5d0acdacbfc9686297d6062a2bb1ca5084feab5239bf756a52206d7fa30c1493579f237a75c7133525254b09caab96e0e50b7831d9cddb60aacfc9bcc686734ead396fd6964cf78d2447d42bab668f9fb35f79e675cdc4cbd5edc9fbc571915310c7325d569b63a3ee4749daf2a0691871177b89b15f5e319980c994a53378d8efecbf9cc404d1a731e250569f6cb390c802973cf38e9a7f03aeec34daeed4f0f4c790b35333417fd7205f69dc1488924344a79fd7b4d912d76e4df88e5d7a8969b050e5b2da2851c2a37285adb35410bcb78756affb2b460aa30503144603dfd91b9b2132c47b52d64c2b228d0bfb065f8b12873f18188f7e6f0af7c4736a387cdba3bfed85d20009f67ead23e41ca2422719c920ea987be49645b2d8b297c8f97a6a2d27cfb99a0d6c64fdac3eb98bdd793653332b9be97c60b495f9ca8c35e2ae41cb0be72a6340d63ab4171768984fcabe12d34b9cd8978fb7274d25ba6b58f1c58eee44b339f280b598613c3e7caf650fe534c3192ade6519e1c23866abfef62c7ef5ee2bc790cc7a440e8b84b2ea26b38e991e682c58b4c1d33855939e85b297ef6316394a9f9dbbea07c8d10875c192298c7a7fa6b5d5fafd7b6036b39a2e4a9a08aa44ca16c5703d2eb87a4643f47f8ad25d6fc79db4811271ba11f36ecb5af7d36fb3f49477f7aef62a2388bbce08cf8f420fac9cacfaf4ce8c19d9dcf261b9a9d24f94bc48b314ae8c891e1c101362df5dd925b6709c8b9f4df69d0eb0e69699b32caa35321fb2063ad5d607dd20998a673a8be770aeb731dbf1d62396bb0ea510dbc8307c94a9f7632b370c755a125fcd65ca22ffa39a6a152c5da8ca35ae2cf7d914db37644adbb09a1ecf403a809febf30c6878961a684690611c09f7c74d64e8fe37dc3b3a26e002128a5f0770bd253220aa326b6a39f88fdfe71ed732583332ebc4e42c45d79c934eda04f0078ae724a969bd695ef162d455c27cdd038fb78d5d4f6c51c1c6f7b019cbf111904e5024f4ef9f674aebfae648913b92a04452ab0d23e87aed6f6f33bae5103469b0e189d11f9d210dc46b16a954bcb695f2fa77de1c11a9511dee26bc64093bb20504e6edd1fd74fb9a913f012141741202e8a3493902e8d291b7b9eefaf7a9e3fba296757bc262d20126de69f579b284a27c8664b846d03fc1821710e65f67a2b9b8cae0e4ded028b45b1fea09da65764b5121d0fab97dfdcae4eb3076c512e866ecaa006c937adefea98c6023d4bf20a739d149b042098b64c74f799b19352cc0c7649a3f7ac0198512d37f82311fcba5d72d4100a2eff07aa524d6a9870ddb141e3283521da0657503a4756b837ea3135cab8767965e5378092dd1cce9a073392f87798251ea4198f1ade88ce65fee997a7acec941f944912f90e2294db5b6400e20d8b967ed671bf2449cc376c769cf59a6041760113115d090e2cb2ca69eaf56ca6a50b7d996b63bc367788976cb69ddf65e26eef2386b681071486144728b82e9b348d815edb734cd4b14b5ced4384d7b12ffb831eefa6b8d19f9bcd58fcdf337b04a9e3b1bf6e60bcc0baaaf0a5a1d8eb43ade31a7e5933a940f60aa8b9cbdf181961c6bd78de670e396b93f24cf498edd5e2e89d4ae174eebcfa9ed4504ebd7ecf2b6fe7e70d37c2b0e7e6c9a50cf1a42d9472d14772e8eef1d2cc7bef70295b4bbef80e12a1a341de6e60178c69836a873609ae9236d4bfb2320f520408cdbb5b097314424a34ffc353a40369fb3c968f26e019e0543ea188082179f883a616ba5cd56805dc1f6a800cc8b14c208c0298c6c8d0140eedaf80eafb8c487a9edbdd8f6ad76ac8021044ec8435218fb37bb61240f779166dcc1c2512ab41090ed1cedcd64352218aaf8d66b13c103342dcda26c13a460a35d75e8b93b8b52fa5fb6ded9e535c3b34522e41f31bcb86375bd211463c5e5d0418a79d970b957a8666e1d16cf738756fa3663f8b1e0db4db77f76957d48e5ce7d3fbf802f05a6bd50efab4929700cbaffa55e5efd35688ef4007d264737ae969a18e0b3d44d8ba8d8355ed1880f76e747f70bd5f315805a2f82195bafa78385726f5e666d58f451c8160ce28ce1a7df2983d1287d529b9bef8c718fd3a512e4290ff3898ff1c1ca0381e0656cbc077090b7042e94f08f619d4b9c3cd198e843df814f0211ebeef4a647cfdc5070f2ce95f2c0c74160677838aeb33330e8be489ee8fdaeaa412733af2fb1b563d071d6f36292f2f4f72ccc82bb0d4281c1300534b1f592dd62aa97a32a658d9ce0415e52841b5efa954ad0b3649227891e0ebb14320efefee7e2adb76766c65a73bef7f298462716ec6391d69fd43abfdd2abe51379fe367b4d5dcdf0113d3614c3ea6ca538314a2537d576081d3b2692a1b27a6823cbeb96a202f141d92662f1ddcc5d25e4a5f605ab6a238c46cb763c7c7974686858a6092c7d3b7a7b0b2e7560c2a50548e34fca07a9ae6423639be2609d0a63ca7b1e35edc7faaeee6c7912e980253b669d7128a2488b1b021603c7e82e4836b6faeec2ac5e478619985aa071f307eaf450ed5681a852d0b88f89395e99f38dd05e370d5fcdf2fe2608a566bf85f56634f417d04e6b45ec053ff2208c3d0c77479a923c2ef71c5ba2bebc7a85439ed5f9045b0e39e0bba74fa74cb0d11cff166975ed986496df3a234ce78382c6de8a4e5492b4ab17a401b0e925c39f6608f241c6ed57723b35057d915e81ed901797c839cd2c7ac705523f31958f31086e31eafff89a57b1d229786d00a7d087aead1e8efb83b1332bd823f2115390a498c9553c499731dc97458fd5fdc383312414afdc69a8d6265eae785cac42af46c7bf2304047419ff680b79148d2d491937958f29484241227a2af656d06f2206e41a529656d751328e7dfed09c411959f91c1caf96bea87d1ee0655682c02b231d84e58f65ec18ae1bed227524187bf363bf0f66b6bbddb22b827dbdee05edc015f759ca8c5018ff5d2ebd937c80ec759ed35fa8bdf679ad7b23be022aba5c53b3ebdfe1d5c8a514cb57e07d2decfefdff2af37a9c9c40eeced342df817ed018e789077a9e2311108778694368969f58107b070ad6022e839cb8f463803d77a5616dcbe4aa7183705e572b4b857ffc9f7486ff12fd4145cd9184801b162b2c3c97ee9aaabaad57f5eb099eadc427a2820f10ce75f3c39744e636dbe6bb245f5454561c0d81f734dbef452013d6383a437297ec7628850981c03c49a2da0e294dba389c4eb93d40c1161bab75f50b1df3b52fbbf813f209bec970480e1dadc342c33621d97f4ee53d8f4e50b5962f92671d26c35b7c6061a0ef730c915db22447b587f3563b1a3466a2556e7581ab15f86a203cb5fda07e3d017413bb6ae94a71194a890864f7b841f95a06f77ff3cc3bb0b5fa7ba00df7f24941cca721a067a0bcc68453da3fb62a750eabffd5f1bf7135ea269803e449d19d947229ef7ec49de0dff7dbfb1bf801398e64cdfc1e160c2b3313e91d2028423f30301480557a7453305e7eda33512ae60443ebc81e2d5bd18a1fe3a5f8f4747789cb02010929e3148dfc074342e07e0766a67baa29b776eeab6ff6878e83f6824a03ede0a796677b0b8a1c4f4e7c0544e81f25738c873149702d8ea82f7f5558c565e12975151051d9dbebe49ae78cf689d93aa2ac3a44f374f99d4eb6402007bb1c33c611b80c7aac5d22d8786054dbfe5f87900bacb81478e899ebaeef0ed408ae9c5338ca8fb33880ffee745c5bf7f31c4354822eb562cc87eb02c9f23dccd70b28c4831118dff2094c881752a87c15b8edcad074f13c8a1e3257e03716081fd30653e6415752f57fe98fdfcb9ae60dafbd01cf50c77f429e80f1dedb10a3ef2dd4d8e4bbed30daae8460efa1f7f5283828dc0fb33a9a41a0a1bac6bdfc6c29b04865333183dae90a06e135b7a13f6d5a4134bb87092681d74b7d1fdeeeb0bba7e81a8793beb9193ba1de02470796e55108713f6b9ee735029535e923dd857605cb98e6b712aac028424e5beaa39deea0e75b97bc24cbdc79c8f0b56508d243a903bb1f6628fa65b50bf2972e6e8ef3cff583f49ff6b215e63a78f4c271fc6d6250177052f28b7dfc719c5d1192ede2dc385c26e95b9758d14bd6608b0214af0fcecc86938f6094cb3e4479437ce77dd1f1b7f63dbdfd67a8b31903ca26757f43b299b32358b88c6b84b80af39d061e72cf29edbe0c0515658870f372ab16e7f43f8ddebb76c79e45d4dd57d336850bf3f2ab732bf3b304886a3b304993c4c869f1c6e45ed623202b9adb5e773eed661ef060128842ef1b41a2d8556d2122c34a4ebe1fdab34ce9abbce618998efa8485623e467f803c4165d5e794bcbef496e038e82780c7fa7dd58f8665668106184662ada7e3a7d6bc3521ff0cfd42f301d61cf65089c14b179ebd306cb5c8121e5c237f23d6445a4de9a2b31846a796e039059c775c6aab071208fa9290f744ab5f9cf0d14c65fb3045632208c57ba2f4e343ea8eb46f3e842384e0e2d53469505f09867a126aa009d4bf861eadd9408fed1b9351cf3c69bf9d69f392a463f9045637885d8adaf1c208dc9fd1eeb954cd58bea7575c7e411ae35ab7538c672912a4641551bdab02a1cabce815c75afc423d3acaaf2619cd0c9f1c065de2b50d9aaff365cad85ff009ceb9a13daa48031f492b504808bd709df03e4bf2c88e0a0245bc11482fe0715f420304994604e2dd84e9c2e897f122d396434829b5435c73d9d02b5522d88c30f7a2dd7ef42561f4bb96b28fd0e4337ce3e52df18645bf1205dbffe454abd18742e4f584db892831032f9648001ab2f9ba8789fea941939b67613eba87a7c4f9f53c9ab9f2afe7fea8f1f3c24a2b8567676635a1a69dc1155a474376abb2d6af8808e8c777d8fc524de49cde66db08f7c6757603c4da82217c1447362429c4bdc98468046f361d2cf59d298c21dd26fcd0d6c25e437baac252736316534278548687acc9444cfe9e1026c7ccae25ed0a702cb7cc2827a3d81561c42456be5134596fd6a74a822b9d04568712f77a2905ca08638cea8b19665093ba5140970b0832c2c27bfe564dc1ece96a5da1737c0852df9fc33dd5b26cd2c9b20de7c0bc5bdecd0cc3c07cea89037d3ff84dea697fd156b4ac3031ca07b270e6083701fcf2f7fc1d97c6d17a3b8e6a7ca9dd706e6bf403f3861db4d2b409279d401c743572469696cef08d7318517a4365baddd8d7a0e541e1be293f23d2c9ae80ee673a4bcce75102cbc0b5b3a438eb886cd746a18b1e32d3e472fa52213b6b54a7ef349dbde9d6e891360bcd6e535d51883d5e1810bf2c56d2b20966121bcc8a7e586af0824d9e0267e804f967b4a62e457f270a9198279da34c03c5d1a55a239ab1d02f9141d446d45af014e16886dd806687c0c9dfed49cd61d33bb1ac0c7b1c22a6fa88b822e82a877c0c2e054f8a4ca82ed502553b484f0fa48e653097558f2a063c9027566bc0265e8c59172f0d9a03699ec46611c226a12ba532c815fd800a20841623b14532939dced43df120807bbd4bff5a8ed4e3ebdbf8f6d9215e1527e7bfba736cf2acfeb716180f7b396e8b54142a4ffd8afff69d07ad0d1a616f3c25c72d16d3cd83d9d6f82fb76feb28b2d555f56568b9bf0589c6ddf56e1f665a7af0b09883f766aa7531d7bf19299fc4a4ae698658bcf99468f8a0a6c6ab63bfa1802c3d038176a57775da5135a2837cca71aa924d6914f410d543aecf73184e02191b951a92c159b2edb6edcc26eace9f6dfcbb7979200679087c2e151840809154fc942732fe1b42fa08993c136498b02835072e39e5f16a05882913930e167b5917ba441cced57bdf2df82029a3d90f79fc872b22e1d2dacc629bb1da52ecb9babbad9f1f4da49831e008634a2d9244ddbc834a73dd5a4cc94014b1b067513dffcfc1cd41842dd6281fb1b7b2c4e445e40bc9c56e5818e7d0f2d0c3ef002102e7863df1aaa574e2af666d108566d70710b9754bec701316b943f17e5754854567900efa6874a1c1af13d368509b1ed939b20cf529fdd1aa1288ae78a2a2edb9c1874e7412c0fe87f866137195c1543448d9efbd9e10122963913b556b70924f22faee0acf36af86b56b937144bd954454830d2d39263856532532cf446ec5631c276ce95e54d5cee523c057296b4e156a6def62addead214a1b9b76c23307120eaec97a8ad65c6af233c46e07aee4439d2c2289b9739972e54f06769d9b22291913e551628d308a202d35eee0459ed0bb65a4124e772ca032365f682e76baf32fd7c636acbf8c589badfce0e70b6352745c1528007d89f65c9af38d96abe65d262669b2c1164964ed270582427bd5e4107868635116b43123df82a1aeb9d1626905dd1e69b2478e733773c205739e618b0308293491c3e5688de7310ff5bbad2a913a4bbd113a490a5335703fe94bc333cfb2366e3a066c231951cbdfeefb8739acc04c65aad839fe976582548e37ee16dd3fd283c6ce20abbe4a61b973108feddfd92bee9e2f5c4b3201871382974759816f61d93cce2b90d277740e8e2277e333c80ae3b5340a45631ced2e8bdaef55d71e82b422f43197d89b16b3a34eff629080141de3600523736da16792dd8690039aed5bfcdaeaaf1573173d0f0d04d3507026ee9d22206ebb45b15a277504f910dfbff4eaf6228f3d8bfab3f7f84161faa8dfe51ac1807cf53ceb30b91d9ba833206be163d987e89a8cbf150023c3f51d32b3331c2f370b7ef216b85cfe0c5a80d36bddcef2a99c3bcbad160501e1ef053d55bab32ebf94c270e1d2633be9802ce26cfe529bedddd62907f4b03ecb871edef0e4f1788a01511fea7f8b7773e872a8b2b111f681ba03d4cf06c169f2ffa2e03b03e3467434ba7e11d07430d255c79d71bd2df24d7ad57405939e2cc2e531de75522d46bbef2fc863f218a737777f2f2525387c501bbc18264557042558b1d5398999ad0222ab144fc426a80a99d2794891b7606b7ad8e4af67c91cbbfcf9033aa77806be4b7c93cd427273ea21fcc47e789c2cf1480414362c847a6daffdd61bd5b4eefe6d2a33693a22f990dd9d0eee6a57760af63374331079e8850bb21f89f50d47b1097e9cbf853cc4caa16ba2b8ed855d4924a2efa4819733e754df284ae0be926eb3aec8acef34f18743530d457cdc794cd4475d19c4b82af31ddbc3686102cb71924ebe50f910bce760ecd6630baa5d0ef5f51566720e04b8dc6f45d1101df64d79125a05b6204e8c6cf894682d1537931184c8997c7259552de6b1a4bbdaefe91c14de5040a1d073d874a37d68100b2fc69914d6419e88febc4e9b61ba4c6512a4cc02eab33bfbe8b0879ab4af601b1f6f224f0e861fca6ed4a12e14c13e429ccafcc0e5ef2e600a585ad86fa1e54a7302471e7bff9fe742c3e7ee306ecd0e25e4fc696aef082256668cdbfc9f8761183689f1c1a2df05fcc526b07821c2cbeb6c047f5e3fbee144ce1c8799c662204a3787c5b338167b79e3d2ba256ab5bb41f2019e444702d01ac0ee8e32ed80db237b0f3605bf431289d18c4fbe7d1465ae053e820dca0364fa36462f8b161cb247d302be38e211b24e88c29d04e705e2f072f4ec81858aed1468920a627a03d884b49f5bab2e65548fcfe874d678513935bf90a103ff8a942358b962d59ea9ea9f733e1c10c27dc8b75d8f4226c1eddabea1f2875346e18f628c3461daffeb037987abe26d6f47ada1244386f84ced1bef6beb33a6ce08273f0b6c35da9352977442aea8adbe0c93e54b3315fc0667f6a0f0a0dc9cc0f3f8c224b9fe4e25a54eedd3bb30fcdb5b162efe4d589e179d92d694d1c727c8e763cbed8785b6d6e1daff5d645acffec69fa2c4ad77e64bf5f9ac69eee5b6118fcbf9d6e5c543b2f5fcdeb5ffc986db0882bec2defd9fe9aafa1df43a42916559c43d336f57e2c304d7afc403a371eac40294c856dd495d409018ae6ea578ab402b6464d02b9dea6063ac532186ed8d6a3d8c31ffd1c4f9e22c6fd08e5a5f6cfde96254a509015e24459e391aa86e52b6668dcbc48650a33023de9475314585048026f7f491c2cd2c2d0dc0bf9e0b53181220976a6c3528f370417e4ac15961c2ee423f02aabeadf7014dde01b18a899bdea5bae00949850a9fc3a45c6a81b21c5eb1472818a292dcf5c7c3e1f9a9c9c3feb301d87d61dc8a3d1aaf273f5732ba2c37af8f47c1f7de57a1c6c855f4bf42d68374edae82da97300cc878ba6e64f9eeb85d00f562ff81f7dfb29ee86fb763de81e4c2f83c19f614cc3ef4f830a6b4bb5830d685707e4f230e452b4bb648ec0b9bcd96dfa4d62d8a3c19ec7b58fe0b21038d1cb379e9c0105953bd179b029d0e4c7eeb513ae10de34c9375d97bb629a4e4ea7e4ed21c12af5aa334f6d6a2de9ebdd748ff03f14ffe7b1d597b5a5eabea022e07ddb4f3bd58232bc4b5ffd333d49197d1ed6b835b8c12359260099d9499806710564d940b521b7b4973f47ebf3fd8070cd8fddad0a806b06d8870f769165f670075e15c382615a5a4e160d0be72acae13bd2a3e5aa5c88c51be0e3032d78c830c415ea3d8ceca8d129e430da4f9ddf7b87935a4f59c151308a04a9096d8621d2199201d9bd272f56245ff04a8dc553d15ad22aacd8b69fe494800776633661c3a0e8265048281104d9f7fa84ecca3f9786c98a4462204e73b840fdd421f85e4ba4c061330ff248cb3097ecd9987853f27c072e6108bf6abbc3525c7c78bd4087faec8a60c57184168123a3808c9e713e8d08261e5dd065649c4c66906a24a2f628e8dc09b1f7bb46ce4a30431853bd8c3d6b1bc08cc83b2a10ca714d49773150a6dcd8d5f3b8a076a626980541e01cdca505308794c48cc2a433e13644f14be461da5662de8c7812b69b78c4a1e03340f39825c05837303ea5173ff96acce816da6b53538d8636894c5c73a27b6bc8029a1da4e54c297965bdd26d0803b5a0ef921cc8eaae32e88a2014899341e2e259412f1cb65dc7825532f7d98c9e050738e83370041dea9fe69425e58496f25173267446ace6e83f31ca5fb4fd66efc8f02bc2eedd5213322a65142125b24bd58ab0da87046a26e69389c88f3d6dcd4c0bbb10479dc0d716e7d1e670c4e5e628f8a975ebdd1360aa265eecbf748a6ef9ba7d8e683bf6462c56078de259c8ec90be8ae849f9b4b5831360213b5d9676ac8ad7f3f72fd549214517be09709055ea1f7137682016fea3123627b178d85c6785084c51fa4e0d68fea6e3e39062fbf9e4e41d0f2cd8009a08ede6bc76ee6e83f6033b29eab95f1082524c10fba167953d8d27023898a73e9038073b3e98c8a4107bd4e5f774d3081897e63bd2727e7aab9ab4b5cbfa14b5828cf7e2e649480131e2143f1c6fbb8ce4a90bd1b1e7d441ab38e0fdf7e81a4cdb0399ae54016349d00b77be3aef57545af65cc546977c0a2bc1183ff33190dfda22fc7cc599593ee833fce7e1d59597ffc2d11d154a02cec2c0fc58ddbbde96685aa3decc8dcb259e9a6c48410a937c6fa1ac883b52ebddbd9257c899ab415dd7dc9cb77528c9e0b192a42d0ad88c5937b48d319a4a2e022d8675a2173ac3f07aad26ffe82e74460bc4ef56db52e826a83dae278625b21c3eb3cfe7408dd1e497a8d5a5bcb50fc982e55e94f1159b9e1302434201317d4c3d60ad21df3771a3ef585a584933d0629d406663c011cd82f6d4300df8944b040a0d232ee26994a8b69d6a3f97eca7059e14d1f155ac7903f6c1b6b3f789e9299a8d7c8b261eacc15fad0cbd98057f4a075cc702d39e0d630730f572fe2e324d8a44c48a0384b145f6c799335c50c5b65dd3a304460301eaa4497066e2634e8ced63e0156d50bb73eec5f8f4f5573c9f67349f29ec76d2149d1dafbe0ca4284f72d21a045ede4268b3eae4397f2219bfda7e24c12a80db7c783e6aa67a32c2853c07791d52785c707a6d6d906b296d9094e7d83c4fa07fce2202880bc5810cec0b33f7e343c356402e2136ea34883bfba2867aeb17224477571a75e47ef2d522f7b877b46f004c1e50f6a0b514a93b1a3e03adab0b55b1fac26221d4339480e64631e5f07568d1ae648a020cf8eac851874602e738d6c1b5397dceab0c36230bdb0862e99578d592d2762e67e4531ac14916fad9bc75c8abe614c410767c7645b898e33f689f1e6ea989051bad62c598c1da69b20694cb71d0e63f9acc2447257943b381d3261b00d5197370122822e9f6ce9be2eebedccdbff61dde9f1a3eca85188089d08d1b24ae5cba1a651b0b7717a987378237dc6af6637d9366d97967816764970847754600b91c958674a103f540fe074e574fad291ce4f1f363e1d5b2dd30bcab6528826e6122dc5ac302ee63ca00843c4b7a9dc49e5f9b9877f5cde439c135c50d496ddcf072d1b675899d20d56a8dc9738d004be10a6fe637ff1616f74ff716e3a45ce2eaed8c9d905f42e4addb0ebad69512b4f96ef7368572f066d9a485f67b142f2b615fda8470e679998e127c52e9987c11c0397b776e0adc10463d46da86a61ca70d1502e267003c1c31e05ef0340c6073dd2c715a8293d85ba5005de8f26f351f5220b185b3b4a636712ddd0356d4a583732e8837f3102c77c69798553b1e4862ad5d8ffe180e0378d99cbce8d2fd2547ceb1b06083ffc63b1ad71f941ca31d55bc09daab54948bac7b47a18ee526079162e3458b56894f89daf4030da5975bea23d8cb7604f55926cc408259429a5f07842e4fd60e2829c2e96186680257195699fcac5ee08647125e1ff0bd57d839f62747b9f21e2e9d6976deda2d69a8e27a169e57d6e9dd5082f3af0368cb600e75d509e440c95bccc9d13390659050dab2317d044f3e1a4d7b60eed2756b8bd8991f08371f2278255681a5857c5f66eeebee7ba1efa274ddefc9e0487cd997311497082c9726fea27cc62ac17df5b00e9bb09330a6b6e50a4362064cff507e42f70bdc91a3ac154751c20fbfd5a08f0ce646c31dda9db8cfc9f0218092cd851a6be64ee4f85f47db9dab8ca56e773386706b3b76261e5e0abf8a10e77888a2a709979dc477e18c0ba97a0ae8ab94854e7abc21ca1cd33c927ed5f07981c14f39015fb6c981d6e0a2264687d1f798526a617f472b550f168444f815b8d90bbc1987f1b43713dc0e33e76c92057beb952d0783f8387801af47c415970464fa20d1a81de3a1dd2234362a520b2708866f48d1f186a8fc3e99bc8714792e02c060830ee3c5442150b997b22c61c4e4e72c2a1e9dcbddf0620ae2b540ec0f0355d5f5890b2ab01da9f3398e98da3dd1b612432f758c5ca40ef38bc22bb3659dfef09b1c7e3a9d69eb197dcd1637a34050d63ecc53618e48c08b8682dd677306356b26c879ca77dfd120fdde846de9b789a90d6390eafbd081754e4fe2b1a7ab98e8338ff49229321fe9b45c07ba834281eb548e71814e5a44edb567d3835d6c23855efd16fb222a2e9c67ed872c5078ae4c013fe85830212b3040f994b2da9300bc6a9d3608d22d7feb30a64a03c218d0996208be60d4f52c6928bbbced8c53f0ce34ff4497051b02ed0038b4412dcf897d0e85cb11e607cc6a6b554afef67b16f6eb81aa24964cbd7a8d620b6afd0382a231b614bdce9b1fe9faeec50ea5a6905fd4c0226ad86a36075f74697d7af2be5847ca16a9ebe1e62fb84a2e72024509dc1e4025605ac564391c49d0e783d05f9b88767c554665cf20341796c7eb418ea7d41b24e9fdefbd9d3c5c9346f4609213c53b0a88c059e441cef3559b77c683dcbe53fd4664aef5c85808ea88cff42bb6b74228e3b0612a8c9be19bacf69dd826765cffaf2d07a903e7b2ff425ad75166e0badf3cf90a6f20d39f3616426e120793e417964283b1b04ea1f79aa7548d995b0f6915529df0de11799b39e01a954815404ac752143d2c8dc09d70a6a8414dba55632d178dcef1bf4203072e4ea322c87c0c8af00c3982594fa70c40968d202aed1e8fc65f0ffcbae3d84cac7eac9059c38bdb45fef79ac0385255eb38ab4bc5700626c6dfb1405c14b0061e0b88c66b4a94b968dda39e0943ddabddefb6b644a4f08675493042cf12c20246390f339d9afa97fc711cdea51ab14c40e4c2052eab93bb08ef6b102b78f62896c7e0182490428c4c0ba478ae04add7f489adf06d15829d994e60363c8a780d5eca66c4577409e98c4fd9f2c480263b599c928b2cb784029b9bc71fbff336b37ebaa33afdfd706695f9f1d072c5fc395f1e3548fdf83303a3d0ef6acee2c06d4a155b93a760417f6daef1019bec870b5d12836834d5f37529f561fa80013f9301742f3533936744478cc413cda8f73bc5d0ff9d05bb5f83945f70134c03b83555bff7c25fb97583812f697444bb23bcbf97dce42efba99aafba7fe179d50be8a4edb8649b74db784675ac826152a01561cc709295a7034bbda5bffb9ca7240a0bf96737ea14986cf298ec75ed7910a2fd26735cb086fdce7abaa33c86b3c24f19f1b2796c40093d41223f43e4256e84fe2aef3fb69dd3b2c2349a9377cac7dd616e2748f04b272e13cbbd298a54fd341b75217a217152884b750621bfbcfe1d61080dfdeb380c9d4abd3d5ea9abf7149dab5284c604af53d62928c37a563e72e77ce1323e861b541948d5a07d25d90fb351234a7d9449e9fbd4c97d92fdbb85c5ec529d3f283762eb5bdd18192daccf575ca781d2cf880eb692967b15645e06f0eb07565fd9533c71dd32c00ff03dbace152e5b026834b06c7e0e6b3f50bb2086cddbf27493a6021cced9123643d76682528397186b13354cbfc6e0197ec48e26fd81c506b181af64b626acabcd63dc09c8580d0ea8f2e8061e2ef6319c176abf30de6f26b4516563265d1ea4df443c504cbdf5e3982b547f811c5a66db249c99ccf1dcc7eb7a272dc39ec11895a3c5b7b6fbe8885830ccb77e01a597e8e1901a6e6071c982507323e6ad5e9aeb7e3e5dcbeb1fa5f5700f3176fcaa0d0d3a4e022f07e96bd76cd63c4e65acc1b76e6387456bdac105de5669cdb91141a2ed70cb0c7bffb1a14ae5a2e9df8943f619011d21cab7708ca5f5b8bab4b01f9ebe311063bee086e8f71d99eef1ef4d6cf2a69bbbc13142d80a11432eb3f7f51420c9b1bbf4f01d9c6bbf4b09af051067fe84fd1121376ac83788f91cb1dbbad5f225e2931e310cf5f5d957ad191c6369d113d78c647fd4cd9601ac164efd00e43e1f5987072198682b91710dd1b99eda0f93c12893838d37e0d82219b28aefb5a94c21b7092c786e2499f68dcd953459757e14955949b59471506c185e05c4445a7163088c30ff8db42e97ad5c391830b60df651bd77d0a64bba99669362922e179c5377d800e942942bd4e9e432de1150942b31e39aab056a83b025d28ff61a76feafaa959bcd1c8a8f5a6d8ae37466bf4d3d941b3a7824069a3b8cdbf90f3f74c832d68527c419fa0afe9e74f14429ced33548c7f5312f783e700769a32a177eadad2edafead7c80e7796941ea9ef8dedd0b6137750819aed2b3036594bfbc8ab529c3de68bc0ad672525cd800d0714f6ce9996ad7665f0b5cec74af4947adea4bf6802ee3f9ac8db3f420fdea3dd939d4810771d2928b391be2986b9eea857ecfc539d659b04dfe79e313d4adf810b23a1a77e42e95b77faaa6bbb5d90c666a62709f8b5dfba53a35d09044fe36a210908b8d2fdabbc51021754f9b2753b4d33e2377b9989500bfad62b4212d9960f2d3ae5e16b2911aeacfc96a3b805ae6a371c3937427cabc7decf4b3ede9e49ef5de3b919e26f7d677a1ffdac005575a00748985e6432982b59efa8a14e07509c2756f385649d1f058f44be5bff41d3434d88a2643f1ffd0a1424e2433601ce63e5b7195663bf605dd99639b5c38cefcbf9b8f3cfc9ec740ffde1479c08e6b6612ac7a0659fc76a58953ad4f26c599824c5254811dd35c883228ca6de8173153ac6bd45b015d5f09f087990a4a4d7eec862a602f70c6b40468df06ff3b18ba47b84c7be4902b2aa144c67ac2ae296a578272fa082096028f59f179e6b5a629c07c2b2d26729bfd3e9fe183dab95447f6685641f6375f60b421a6f09940a12da386eb7b95e28215a84ab8c7bd55b7d9a4f32e1bcb6ee7b13784baa8286df62dae64b60bd06969740bb7ab0a5e70e57e719b91cc450600418622e6eaf9b93d3a1f4d8b6e83399321c5a840bd760c22e1e351ef959ae954eab754f5b025a71b24aef7c88f06d01591c1d1625fc61b81ce1ebb4c1f7ef35299beafd95f06ca4b0511a37adfc1bd0b8eaa949c071a9829cc2aa580e0dfe40ce664df512b543a9e41bd4cffcfb2413673bfa0b7ee0681711337d2e32cf99ed96c89c76753b6cff305fc83f8e46d1edbef5d6830c7bc7809ed81857253aa37bcd68d8abab4a53bec4f62024d837e5ea60880da2290e0df352e7721298ae25cba6c1c4a62fca4d79959e01c9e827e6806c3211fb7818be33e280923d12b065aa1872a9895364f4b88fe51ee1b1e116c176f50e328eeca302ffbccbf7487f0e9c9eebc0c0528b416722b209038abe44379a7f00dddbd1148a5573c3b534ee6a269c1f936ff020c9ee7bfa4d86a679729f354337962f4aa432a0cabecedbcdfc6c780afc50c6ebd1be2d2ac32716e55c3a8e7c62660ae14ab5cb27907523aa5e9ee1cb8e5813b6129a88bc2d6a663793e39b0e8efb29ae3e8f5db85a3e04ce30109b3a41c269dfd9884853e7006688786fde5054418a588a1c1462f3ff1a30b4894de5b9d46fc99198a8d15f11c41e8707099c864778708dc616688a0ec4078fdf864d94418dffb5edd06aa5a2bf01644a3087007b10a5e639ff3f0a173ba4e4b54e243030e79ee2b2ab9c3b111a782f51553218328f74be910b222d970087e632b0def4bd16b5b5ef13426af02bfa599f593d34be43cc6d7220c65d423ce7d5b662a3cff1e670b1f7e78edc1085164051217ea063f00eb35d288025db1156eb4930c710cca2f99b2c309da07ca885b7c82c0abfa3e3081c8d0841d98b121f02a21dd91994095384c0b1898d29c3fdcb43c98ec5bf7d1c9ee008981790dfdee4af27d746b88a35623bb343167a6f47d9707229ab49d8f10f3a945b8dda2de63a3175d590f024697f80cc920c7f6eb8ff79b63d362ebf755316c847046e5f47f519a862cc5fb21575837c970b2b8a967313fc9b29f5cb3801693ae38f8bddff9b8eca1e3242eae44bea21e3b5040bbee7ed64f5b017b39085936fafa48c4875f8490057a57b95c0906c1a99655afa48c55f5dec56307ccbc6358cf88bbc91083267a1b1fc5c874edf7190cd199e60bf5965a65c0fb9cfabf8b1f4d9d75523aa6d4c52701c82b6ca31e30fbd9785878de50a39e5f1a6d096be04763792d8081125df007f8b4f946fd4332dbb0ad6d0765e6900cc516b83c14d7457346d75acaeeb6d4072ac8ca467f033c1ea3a21bc81d5f191d733822b96ccbba258906969f9b09368e791c575ae0041f0000f1806275dbf45e9259491167f28465758fec49699a1f9b72b400363c05a1a4385a7317c8b57e49170f19496bcb922dd4e4813099d31d639ac295985d62b0589a546c22a8d376882bcba7c17a207a4fdba08966fd2ccbf9b88771f9094ce3e202570b747d9fcb53860e33578567c52c2c55bf8a37d5ac7d2e41211c6d1c5f8613bd7fff2390df2e0869a30594c9729daa5fbb01817ca82439a08a0f745c9572a9935c63d7ae2282fcf0946a54ef49932e54edd7e198f59797b925fff7f280fbc2471d4c9093ec7bae4d8c8d3cae0feb16626b0d3986b50e48da669f4ef654e4a368fa36f66d70001c6e7ceb37701184fa8c27ebe83e1ba72b64ffd741f13f7bf65698d6a852d266ee5dd1babbb332cd59554ce86484f6754197f9b8d467071a0327492fe3ce508e8141915b7243717ec354fcca8d767d6598d3b170c8bb02fe2f48fa1978a7202a053154d6b8f99f9109c440d100ab86b72891d471c1cd57cd164a1e3ea4ca6577a31e993504d06f878dd091e0fd406bd10bfce9311bf0f5dab7fddf88e8dbf3a31de673e7b7474b3257fa2108bba11f7c700b4fd78dd198ddaaeb33d5eb264dddfe052c80985869c6cb28bc80050f791b88816db02d5f7523c5984728c292d0018eb6506772254d98dbd1a1f0b50d2d5808b939e8ad560ce567a9b642f2db67c1dadd0523ee68ffc0e518f3d0a08d632c549e6c18ec2a376cd8452e289030b0f6928a2313abd340aacc1b1bddad13e2872da4f67907606e1825c6fcabd1b447e36948eaf5d1514c3ef0e1d12a58a2ba354a80cb86bcbfe3ea4844e0b8a952bebbcc23b9f7903cf1b5fe41aa43500985c6984666e27832aaf7d86233fd1a8b8fd2400d1dd285e982d50e27dab380c6932183a0226f7645a26a0edafeffa4f1f77d44aee805a1ef13050b0223993a2b826d844377cb0a157cd1065c04d6c38ed743bc8d7504cc1c4df2e9d6f03619eaa7afece25fe045e508bb0d11ecefd1bb57476c7f15c46f7b558acbad7e4e762c5dba1ffb52edb0f985e5e7d2326e1e944b55eac50fc10c3dd6d744a6f3c7d070699fa005591fd790f31c19bae5e707f5f7761fc9dce539fe18927467236af096f4bb3fa9ba97291c9c2215bb9db36ecf0a07d0004b0c71f2c43c55305c0dd804fe088efbcdb448a83341208bcb1dc294192d5d65aed54980b2fa2d332ef1c85aa9a2e0fcad073bb28b35500dbaeec2987edac39b2707669000488f923f6048c4a6aa73ef97d980ffabcf59c87faea1ce753da57ec17e13a4cf8bb692ed88424fef6bb4b6b06d96ca277bddfe9cddea9f98c8573fe1b4676dfe6245c57684390ac602ed396cb473383b3f173ceb1917727a10af568a4e8550f090a5999d3dbfd39bb2ade3e176bb155eedb1f924798db8f819b618e86564a0f2daa8fde91524bb4f4342c42fb859e2a0c70671200f6199bd98cad827ae767149aca2080c7e6eb6acdb02bcc485049407640568a4dd8d3aedb611c9b31d9e542fd2ea5ffc6b72b4bd1fbf8c70455e9d9a78caf0644abd552595677aab057900662fa6ace32725afc3cfe6dd810639f85f095c4c880adebd648700ff21597791fc2a676ce5f4af8ad7a490a38577e30f8fac077bfc307e13a737ff7ac383a77d06da26821ede6a07d9e899493c321ba1b74127686116d957e4f7a7cff604b263cc289abf71088417ab8019c8bb533b0534e74d81341023440744d22e63c106daf01100dcf2d0221e8d197f7b5c4d7a37ec2f9e383b6c0ed1e8abec452b1288284b27c8bf94ff6f9e29b2beb466ea8b921b41aaac771667abc8ee9db4a68928ed328d2b77990f852c0d4a8858f75b441310a92d04441165be46e2a101051cb365c633067dcd4e537819b35b5fd503c26cf63ddd33d33bc7ba030fc51f5a6cc946ff45efa0c8a72d6aa694bc6389af8d30c0be470ed6741b36c1ce7cd5d3daccfe675da46717e4d046abaaf5e8a4cfc14de317eb6d7a8cf7274aa1de788df0d13e4b0eeabaca1dffd1e4532b8679d35cde691e214dfdc122122e00c0704d42f0d2530a8bc0e87411dacdf17d632371e53fcf4ac2472123eefbbbfeecae01c330c1b8328fdb45379c8a9eec5f020a9954c13d46c8719cdfcf2b7fa69f8fe843fa2a89a07b7bb26b4a8e1bffe438ea2e301aa499750525d241b09be7061514200259880229961e5dff13b86463d12924e0167560f7d03749f3afd6ba57181e0f73bc406149d78da69720142bd7c77270cf29c69a2726bd8271fe5fc83fdddd258c605a9ee65e26f4e9f0001134a1e9ab94f0c59195c75543fa7bb3a9c612e150a72c9af591a1dc1fc9cda4393cd34b97782943ad3582125f2f8cab06ac1f4f8c767320b0d81bca8af1bfa5597d98aec796dbb51679c21b8cfb4e769c307271586ff9c5bedf9e1995327e676117821f17dd80bb04d984faef8252e7de3154542aa1ef67817173452a364fef33f70e79c8801555e1700eefb8ece2401eb706cc8946047e323d2c101b6b0c1773cfde13caa702b5c3875f6bf3b09c6d7a314df6b71e2d680c99c90e9cf70489cefce08fe2303cf5b01e50406c514944291bb2f88308b7154fc663f1e6d98c9adf7e198115c8add6ef8056ff438bec26afd209048683e9d8c83d0965ee9ba84d98322303a424575d397480ae72a011156b3293dab9708ef8c9e34e8f795b0585613c4d6bde58aa94be044727a04dfe486294ded140356145cc979a9c0a0f9cfb0c3ae624bb55076f52c26e9fddcb6fdeb37fc12000fc4a6f1b09a3f2a54ebe710e9e6620dbeffccd324dfd76aa561926e585f882e40637f2b96ee958164e897e91b3fdb1525bafdf04134c7858dce23f7659267101b191986943f760a530bd50e84c62059bce2a71e302f61ab88429e5fb95b615803c2c9a49fa3de15243ea14c79466d868150239bf0f14ac218971667666e72e8aef02beefc53e2f7e71f62b7565baa040b4b48edc223257c06f6210a9465b2e2a948c2ebbc8d9199ed7f86e5fe59905d667fddf5a81b4b9720b7d3787122b1e863be21872d809d40279c304705e4648bc0a3d9cf0bc37492d1d1b7ec991ad8daf2d89ebefe711e6820645211709da3c5faf0cbadbb3b0e90838e0978c16efbfa428f2c27d624d601e8fdb32507ce75dbb32460e40f426bc7f1dd8b81a9aca745dd97276fce5c6d2ae8988022f522aa7adcf0594bc20f2b4bd25b0f9db923d4e5e97c423ccfa0b4f1ae17a762f472f50aa325a98bcd6f663bbdec041dfeea7fe027d5803eb969cc806ec140c2c0cdda3dc1e3ea0d9664ff63a8dd442754cc3ffa0f71049bf758d8579cc8d19993c755a1eb4e141724eba90ae488fdb2eca115a276650e3ea5d0957275e3c689e8f07d2dd08b6fa00bfd7ec751072b8184b1b2f5bc869261be72001ff32bc37dfb2a00f92cddee9e76afadb6fc56e3e0b31ee9f8a679e5fe4b7db2567e230eeff00c2fcbcf17f7d0471a327af60bf0c1930a5ef038b1aff7cb1b701259094525d4d21257202a46e364283078906c0914fdd2892cbdf46920a4cf610f3b20a4fd7012976fe931a605f6bcfa1820babe3b2260cfff6ab45ed2d23c03253c57fdc7d58fd920fbf7d10fa3d4eda059dbc0526fb2066a0a634040dc6daf03db5580618d533125dc86b3a86609355b63898f5e5c7e302ea4b8d9851a1f5d4a39f51718287b94542028eab1ff2c2e83c8cc9ef82fdb67e2be2ec1334520643c551fc1de1a970d3f338f2334562b38c26901c57e953c39296a267644f0b534180e1d3b4d707a76a24aa55cbbe150ab6a9684b65c202a367774d33d0fc24c8acbdf8f9755ce888e46ae1c8faec8786ee665af2860a1f6daecf63dbeb2b71a82ab68d1901f0886085eac584dcbd382b4fe2196987565604a525cdd070735b419be19cb9ed4642fc8b7b938600f24d462dad0a6897531a868f2c3fed52a93bb6daec98ca048d171c7331dfd35c0c3d6c5d371428d4ed114985d6ad0338fbb479f046851cf9f7385892e49ad3d1491bb7e744a569596fbc7bca0cf2ba4c0b69f5ebdeae9a7ba1c003de39de7d13ee587ba65feba7be46822016598c66a4f47d3233a8fc9e2471bb2aa78d3552efd857fc7577fb0562cc26ada873a2b0b5aaa3c1e384239918b5d9ed420feafa2d90f96e570cd3e552d00a06dad60ebbd19e12f29235c2ca943fe81822251cd553ecbc9b4a067a59da1f4e9a5cbd8b06f4ee929cbfe5b4cd1335cde8ec7a47b3b427c328595fbfccb1d326eb105f1b968296b543cc94af8c26a493edec8a5e5fbe34ffa339fccdf8f7194be5d28ba0696496d46a3fa0017aab6834e6876b5ded6c370db9b0ae5f8d7092213a78c1584a2a76a514564967a4083dd9b3e92da2f51749179f03c6e3b2aabc4107afcb11e153c8117f1e3c7667abcc61a7c358c4227ec987ca9bedf2588cdcdea13d483bbefaaa64ff23001f01a907e2cb4fa35916920c1b25520b7bcca6add8919c4fc501d8791381ca56c5af1e2a9c38e5b06fce878e2e5af1b5ec497b7914651572132d02542a9f8701c22b2479e81148f0109b0b6bfefe6ef8ace9e8ee710784c34b8c2f5361aaec8bae5d0ea7349fb8212372806e81aec288d50b6b0c5516726e4a693b35864f0f3e20ca3061da2b4da5a24c4b904d2a236b3da08496026cd1390d46baa3ccaa18eccdbc11868d940fa0c68aab4523e4baac312023386b47219ff3afc8b642d148e8cecfdefebcde9726fff4043eec332ab3daf022d914c964cc521d375e6b19a17c65fd468a7f393c70ef2a284cccd50cd7c44898cffa12c65f924e873d49fb7bcdcfc230bdc3b4f6391c47c48b02f1318eba71b40357665b4ae4971e55c5513ff87c9714bc05186a4dcd7e520d5241c753ced9d76ccf9c4495325cd2ced11d4a64cd942266e65c5a8adfe58c64c8658fde6a835ba301ac70d9844a4971da39c4a0172ab432963a92cdb2190871e375e740f7a65823fe42cd08dc6daa70973c8b1ac44c3e5afa1079323aedfecac5eadef10d4bb7678c6e273440884b8ef9b61e7aabd11fa6e8d5c37ce1d34c94619e6f37c16cdec51eb1ed06f237966e8e6d5db5d8da54632d3a15a0744e961b4fb34de8e5e95a36f70ef95ee182b686e78aa5720e5e5129b079a3fc04f726fdc3cff6ebcaef9892e05e523d20dce8322118afad964d5a776a250a655c98c1c96e0ba054f7757bc6c9a27f10b9527e9d173cd5a4921ac73c4134c5b14e9fd109a502d7219f24ebb2cf528ee6b5323e368008cf12fb00c309ac41420966cbfec1d30dbdc53509d12839459a8b1d2f99963050be2e037479bbe4bc2df40d3284b8710fdac6ca714a136abb2b6ce01b3f92ddc29bf60c3afbf6795cc30e5933fd23057bfe722144ee623c7cbd3fb7f2953586bd54899a184e71dc82067c653656b15d29dd864f8540d4cb1d737df3969e9dcc1b4338ef418012456b37f38da7c3107086205bce8f16c906a83b71ec4b0b280cdfb7cbdcc330c714e8a784ec619aee74b9317dcf07853134cf3b88b21ada7076577687e5ce8904fa18960287727b007f045495352f66139eed3006de4e8e1fd2a1dd44acaa68c638833de6a3d99b46d2d1d6ef79d867ed7f8bc6410648ac417b02f7edf106e33d65c69b826dbce93a971cca222a68e019258138f363a08c1db1c58a8559f9454f8cb93fd5002974349fc3790ea0b73f8cb30a33723c7b6d4dbfd5ecec1cdeb6217d612cdba5d38ebc895d41957775107e5944d9ce8c038122cf85047c26ffe74a2e1785cc5a0a817eda750d19cf0f2ff7bc60ffa0697c5c4e5605c52b7e6b00ccdca37c54ba415602f199e96540ca52803315dab8cd7c491348892804497dd773757352506d5f2786b601fd21e7890943b9cc58203ee4e175f500edaeb9b93809bd37c61c00b42a32e25ad228acccf367b194279732dabaaff5462ad1d259794d32c042ef41504039563f132b6653ff677dfbe78aea549b5841600706228dffb30e03d4df3833a5fda8fca6e0499eefcaf8623c414165cf7d58854591d81fef46fb3319eb4f374d9e6b29956d048d940ab28070eb0c311038c5e62ae0143ab4673ec92e1c668ce9f2e5255eb279c195ab694b42fd80c9c0bc5bc33a72c0a6762a66df19831554b5cfde06eeaf9fd1a9285e7ab619e9cd2a47a4120db1ff7b122157bd2ec0133a33758ca32481f7e63b0f17b2fe02fe1876d79450aaf7c9122470b6ba838f63daf51815edc6e73eb2d3a28302b76f02d2a68511d5805ed933fc890d2f18dba22ad301ac62b2f5acc2dca16a7273ef615fae4cdc7d55ecb9572a8bbd71a8e861bd1f421c042b64d7312f38b408bbaf9a80d5e4ed6e1459039a8f45fa76f5601f1ab7f701f0c37d7fd7605503172a33a290e99be5962cce469b43986ec5eb6afd8ac5f195272163bf3217fd0c2deceedcfdb41111f43cc4a69c932ab487adaad9d74ee775f6320438e8778324a063eac664e4266a5e08d0afb7ddb226bcee24b3764cf7703d0a162b2c3aafb582600bb7f5192d6a10422fceae90e6c50f045568ff7bbeac5cb62af3f3c0879cda720fa70acdf9e1902f796ee14a8b423f2f803773cc6b62381cde05e3462e126b01bde76704f5df7852bf9aa6f6dd850b4f3f05cb4ff298d070926e17199adcef180d9210012a441940255fd9db190e691b6f537f72b5b2c6920df145ab8aa0dc1017be978b9047e5b5d60771c69d9ead098574f9c545f61137e4eb2f68177f0f44c73bdfdb6d77f61991e38ae52b783e1b64380d7cee2ca9bc69e07034f146539d3775df1df7d52fb628ad598e8a421a267a9b117f49ac9b2f959935f9009faccfdd451c039437423e001c7453db7301f5119b6f44bce23be7e6fc905ca61aec22ec790144160462f8fbd75870ff6b478735ab7915523ac507fe35027dd43ad77d9d7b9c866e64fcde5e9c835b5e454fcf0b230dcd9e8dc534d1b9c182657fbee2ef8d086fddeea3285b46d01d507b5d1747cf5207153cc236b5e92dff47c40130a85e329aebfac06cd5e15d8b7ca1f76e2564ae0fbe2b97d12cc8f325bcac81cf62c51aa3c56d672ea9be85ea987e3f5ca00ba200c96b750590fcf30d500b8d71ff236771e21d483a2d42e874da15df63722eeffed46436572900cc5ff058209fb1fd425b32c9381a42216ca3b31a0eedf78cfcfbb36a4b936f6800500b233713c76d6f0d325c1bb464339cf4c57dc86c469f5874b8f6236bf33686eb6d88ffb1bb5235920e5d56dc4ede4cdcd498260616903b909e13587a388888e0a78b640ff459ed899a3d9cb57e68d1c3a86c6264a5a67c81fd64cfe8114c011f94d6d2d569455bf86e79a1d7fef325ded4acf77d71b161c741e756c0386cb739b83bdfd275a4abb470f1d536fab911f6d3e1f4dc8c1edc2fb984af0595da2ef556da6e09b00d37afa841ac0c0aac0264a3807f7c13f16f50972")

        val decoded = WireProtocolDecoder.decode(pieceMessage, 2)

        assertEquals(7, decoded.messageId)
        assertEquals(1330, decoded.ints[0]) // piece index
        assertEquals(0x10000, decoded.ints[1]) // begin

    }

    @Test
    fun `handshake encode-decode`() {
        val peerId = "01234567890123456789".toByteArray()
        val infohash = peerId.reversed().toByteArray()

        val encoded = WireProtocolEncoder.handshake(infohash, peerId)
        val decoded = WireProtocolDecoder.handshake(encoded)

        assertTrue(peerId.contentEquals(decoded.peerId))
        assertTrue(infohash.contentEquals(decoded.infohash))
    }

    @Test
    fun `decode handshake message`() {
        val handshakeMessage = hexStringToByteArray("13426974546f7272656e742070726f746f636f6c00000000001000051626d935781a09b76ee7afd7aff98727fc3b705f2d5554333530302d3aac6c016830e66a93f32e7b")
        val infohash = hexStringToByteArray("1626d935781a09b76ee7afd7aff98727fc3b705f")
        val peerId = hexStringToByteArray("2d5554333530302d3aac6c016830e66a93f32e7b")

        val decoded = WireProtocolDecoder.handshake(handshakeMessage)

        assertTrue(peerId.contentEquals(decoded.peerId))
        assertTrue(infohash.contentEquals(decoded.infohash))
    }
}



@ExperimentalUnsignedTypes
fun hexStringToByteArray(input: String) = input.chunked(2).map { it.toUpperCase().toUByte(16).toByte() }.toByteArray()